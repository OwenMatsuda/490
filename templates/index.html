<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="{{ url_for('static', filename= 'style.css') }}">
        <title>Digital Nurse</title>
        <div id="visualizer"></div>
    </head>
<body>
   <h1>Digital Nurse</h1>
   <button
        type="button"
        class="btn btn-primary"
        onclick="setPatient()"
    >Set Patient
    </button>
    <button
        type="button"
        class="btn btn-primary"
        onclick="getPatient()"
    >Get Patient
    </button>
    <button
        type="button"
        class="btn btn-primary"
        onclick="startRecording()"
    >Activate Nurse
    </button>
    <div>
        <h1 id="output_text">SAMPLE</h1>
    </div>
</body>
<script>
    var startRecording = async function() {
        for (let i = 0; i < 5; i++) {
            res = await fetch('/nurse')
            console.log(res)
            if (!res.ok) {
                await new Promise(res => setTimeout('', 5000));
                console.log("done waiting");
            }
            text = await res.text()
            console.log(text);
            if (text != "") {
                let output_box = document.querySelector("#output_text");
                output_box.innerHTML = text;
            }
            //  res.text().then(text => {
            //     console.log(text);
            //     if (text != "") {
            //         let output_box = document.querySelector("#output_text");
            //         output_box.innerHTML = text;
            //     }
            // });
            let wait_time = (text.length/(165*4) * 60 + 1) * 1000
            await new Promise(res => setTimeout(res, wait_time))
        }
    }
    var setPatient = function() {
        fetch('/set_patient',)
    }
    var getPatient = function() {
        window.location.replace('/get_patient',)
    }
</script>
</html>
